{"version":3,"file":"4.9704f24478abca0120c6.hot-update.js","sources":["webpack:///actions/index.js","webpack:///components/Header.jsx","webpack:///pages/index.jsx","webpack:///reducers/index.js"],"sourcesContent":["import fetch from 'isomorphic-unfetch'\r\n\r\nconst backendUrl = 'http://desktop-9pqed1r:1337'\r\nconst authUrl = backendUrl + '/auth'\r\nconst baseApiUrl = backendUrl + '/api'\r\n\r\nexport const REQUEST_CURRENT_LOCATION = 'REQUEST_CURRENT_LOCATION'\r\nexport const REQUEST_LOCATIONS = 'REQUEST_LOCATIONS'\r\nexport const RECEIVE_CURRENT_LOCATION = 'RECEIVE_CURRENT_LOCATION'\r\nexport const RECEIVE_LOCATIONS = 'RECEIVE_LOCATIONS'\r\nexport const SHOW_AUTH_DIALOG = 'SHOW_AUTH_DIALOG'\r\nexport const HIDE_AUTH_DIALOG = 'HIDE_AUTH_DIALOG'\r\nexport const SUBMIT_AUTH_DIALOG = 'SUBMIT_AUTH_DIALOG'\r\nexport const PROCESS_AUTH_DIALOG = 'PROCESS_AUTH_DIALOG'\r\n\r\nexport const requestCurrentLocation = (locationID) => {\r\n  return {\r\n    type: REQUEST_CURRENT_LOCATION,\r\n    id: locationID\r\n  }\r\n}\r\n\r\nexport const requestLocations = () => {\r\n  return {\r\n    type: REQUEST_LOCATIONS\r\n  }\r\n}\r\n\r\nexport const receiveCurrentLocation = (json) => {\r\n  return {\r\n    type: RECEIVE_CURRENT_LOCATION,\r\n    location: json,\r\n    receivedAt: Date.now()\r\n  }\r\n}\r\n\r\nexport const receiveLocations = (json) => {\r\n  return {\r\n    type: RECEIVE_LOCATIONS,\r\n    locations: json,\r\n    receivedAt: Date.now()\r\n  }\r\n}\r\n\r\nexport const fetchCurrentLocation = (locationID) => {\r\n  return function (dispatch) {\r\n    dispatch(requestCurrentLocation());\r\n\r\n    return fetch(baseApiUrl + '/location/' + locationID)\r\n      .then(\r\n        response => response.json(),\r\n        error => console.log('An error occurred.', error)\r\n      )\r\n      .then(json =>\r\n        dispatch(receiveCurrentLocation(json))\r\n      )\r\n  }\r\n}\r\n\r\nexport const fetchLocations = () => {\r\n  return function (dispatch) {\r\n    dispatch(requestLocations());\r\n\r\n    return fetch(baseApiUrl + '/location')\r\n      .then(\r\n        response => response.json(),\r\n        error => console.log('An error occurred.', error)\r\n      )\r\n      .then(json => \r\n        dispatch(receiveLocations(json))\r\n      )\r\n  }\r\n}\r\n\r\nexport const showAuthDialog = () => {\r\n  return {\r\n    type: SHOW_AUTH_DIALOG\r\n  }\r\n}\r\n\r\nexport const hideAuthDialog = () => {\r\n  return {\r\n    type: HIDE_AUTH_DIALOG\r\n  }\r\n}\r\n\r\nexport const submitAuthDialog = (identifier, password) => {\r\n  return function (dispatch) {\r\n    return fetch(authUrl + '/local', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({identifier, password})\r\n    })\r\n    .then(\r\n      response => response.json(),\r\n      error => console.log('An error occurred.', error)\r\n    )\r\n    .then(json => {\r\n      if (json.error) {\r\n        alert(json.message)\r\n      } else {\r\n        dispatch(processAuthDialog(json))\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nexport const processAuthDialog = (auth) => {\r\n  return {\r\n    type: PROCESS_AUTH_DIALOG,\r\n    auth: auth\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// actions/index.js","import Head from 'next/head'\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux'\r\nimport {\r\n  showAuthDialog,\r\n  hideAuthDialog,\r\n  submitAuthDialog,\r\n  processAuthDialog\r\n} from '../actions'\r\nimport { Button, Modal } from 'react-bootstrap';\r\n\r\nclass Header extends React.Component {\r\n  handleAuthDialogSubmit(event) {\r\n    event.preventDefault();\r\n    const data = new FormData(event.target);\r\n    \r\n    this.props.submitAuthDialog(data.get(\"identifier\"), data.get(\"password\"));\r\n  }\r\n\r\n  render () {\r\n    let { authDialog } = this.props;\r\n\r\n    return (\r\n      <div>\r\n        <Head>\r\n          <title>{this.props.title}</title> \r\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\r\n          <meta charSet=\"utf-8\" />\r\n          <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\" integrity=\"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u\" crossOrigin=\"anonymous\" />\r\n        </Head>\r\n\r\n        <Button bsStyle=\"primary\" bsSize=\"large\" onClick={this.props.showAuthDialog}>Show auth dialog</Button>\r\n\r\n        <Modal show={authDialog.isVisible} onHide={this.props.hideAuthDialog}>\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>Authentication required</Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>\r\n            <form>\r\n              <div className=\"form-group\">\r\n                <label htmlFor=\"identifierInput\">Username or email</label>\r\n                <input type=\"text\" name=\"identifier\" className=\"form-control\" id=\"identifierInput\" />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <label htmlFor=\"passwordInput\">Password</label>\r\n                <input type=\"password\" name=\"password\" className=\"form-control\" id=\"passwordInput\" />\r\n              </div>\r\n              <button type=\"submit\" className=\"btn btn-primary\">Submit</button>\r\n            </form>\r\n          </Modal.Body>\r\n        </Modal>    \r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    authDialog: state.authDialog\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    showAuthDialog: bindActionCreators(showAuthDialog, dispatch),\r\n    hideAuthDialog: bindActionCreators(hideAuthDialog, dispatch),\r\n    submitAuthDialog: bindActionCreators(submitAuthDialog, dispatch),\r\n    processAuthDialog: bindActionCreators(processAuthDialog, dispatch),\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Header)\n\n\n// WEBPACK FOOTER //\n// components/Header.jsx","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { bindActionCreators } from 'redux'\nimport {\n  fetchLocations,\n} from '../actions'\nimport { initStore } from '../store'\nimport { connect } from 'react-redux'\nimport Link from 'next/link'\nimport Header from '../components/Header'\n\nclass HomePage extends React.Component {\n  static async getInitialProps ({store, pathname, query}) {\n    return await store.dispatch(fetchLocations())\n  }\n\n  componentDidMount () {\n  }\n\n  componentWillUnmount () {\n  }\n\n  render () {\n    const { locations } = this.props\n    console.log(this.props)\n\n    return (\n      <div>\n        <Header title=\"home page\" />\n        <h1>Home page</h1>\n\n        {locations && locations.map((location) => (\n          <div key={location.id}>\n            <Link href={{ pathname: '/location', query: { id: location.id } }}>\n              <a>{location.name}</a>\n            </Link>\n          </div>  \n        ))}\n      </div>\n    )\n  }\n}\n\nHomePage.propTypes = {\n  locations: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.number,\n      name: PropTypes.string,\n      url: PropTypes.string,\n    })\n    )\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    locations: state.locations.items\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    fetchLocations: bindActionCreators(fetchLocations, dispatch)\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HomePage)\n\n\n\n// WEBPACK FOOTER //\n// pages/index.jsx","import { combineReducers } from 'redux'\r\nimport {\r\n  REQUEST_CURRENT_LOCATION,\r\n  REQUEST_LOCATIONS,\r\n  RECEIVE_CURRENT_LOCATION,\r\n  RECEIVE_LOCATIONS,\r\n  SHOW_AUTH_DIALOG,\r\n  HIDE_AUTH_DIALOG,\r\n  SUBMIT_AUTH_DIALOG,\r\n  PROCESS_AUTH_DIALOG\r\n} from '../actions'\r\n\r\nfunction currentLocation(\r\n  state = {\r\n    isFetching: false,\r\n    item: null\r\n  },\r\n  action\r\n) {\r\n  switch (action.type) {\r\n    case REQUEST_CURRENT_LOCATION:\r\n      return Object.assign({}, state, {\r\n        isFetching: true\r\n      })\r\n    case RECEIVE_CURRENT_LOCATION:\r\n      return Object.assign({}, state, {\r\n        isFetching: false,\r\n        item: action.location,\r\n        lastUpdated: action.receivedAt\r\n      })\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nfunction locations(\r\n  state = {\r\n    isFetching: false,\r\n    items: []\r\n  },\r\n  action\r\n) {\r\n  switch (action.type) {\r\n    case REQUEST_LOCATIONS:\r\n      return Object.assign({}, state, {\r\n        isFetching: true\r\n      })\r\n    case RECEIVE_LOCATIONS:\r\n      return Object.assign({}, state, {\r\n        isFetching: false,\r\n        items: action.locations,\r\n        lastUpdated: action.receivedAt\r\n      })\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nfunction authDialog(\r\n  state = {\r\n    isVisible: false,\r\n    isSubmitting: false,\r\n    identifier: null,\r\n    password: null,\r\n    auth: null,\r\n    error: null,\r\n  },\r\n  action\r\n) {\r\n  switch (action.type) {\r\n    case SHOW_AUTH_DIALOG:\r\n      return Object.assign({}, state, {\r\n        isVisible: true\r\n      })\r\n    case HIDE_AUTH_DIALOG:\r\n      return Object.assign({}, state, {\r\n        isVisible: false\r\n      })\r\n    case SUBMIT_AUTH_DIALOG:\r\n      return Object.assign({}, state, {\r\n        isSubmitting: true,\r\n        identifier: action.identifier,\r\n        password: action.password\r\n      })\r\n    case PROCESS_AUTH_DIALOG:\r\n      return Object.assign({}, state, {\r\n        isSubmitting: false,\r\n        isVisible: false,\r\n        auth: action.auth\r\n      })\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default combineReducers({\r\n  currentLocation,\r\n  locations,\r\n  authDialog\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// reducers/index.js"],"mappings":"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","sourceRoot":""}